<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./chapter%209%20readme_files/filelist.xml">
<title>Outlook 2000</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Richard Deeson</o:Author>
  <o:LastAuthor>Richard Deeson</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>2</o:TotalTime>
  <o:Created>2001-08-13T12:46:00Z</o:Created>
  <o:LastSaved>2001-08-13T12:46:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>894</o:Words>
  <o:Characters>5100</o:Characters>
  <o:Company>Wrox Press Ltd</o:Company>
  <o:Lines>42</o:Lines>
  <o:Paragraphs>10</o:Paragraphs>
  <o:CharactersWithSpaces>6263</o:CharactersWithSpaces>
  <o:Version>9.4402</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"ITC Franklin Gothic Book";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Baskerville BE Regular";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Times New Roman";
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Times;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h3
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-pagination:none;
	mso-outline-level:3;
	font-size:13.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin-top:0cm;
	margin-right:-5.65pt;
	margin-bottom:0cm;
	margin-left:14.2pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.0pt;
	font-family:"Baskerville BE Regular";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.MsoBlockText, li.MsoBlockText, div.MsoBlockText
	{margin-top:0cm;
	margin-right:-5.65pt;
	margin-bottom:0cm;
	margin-left:14.2pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Baskerville BE Regular";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.codeforeground-PRODUCTION, li.codeforeground-PRODUCTION, div.codeforeground-PRODUCTION
	{mso-style-name:"code foreground - PRODUCTION";
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:5.65pt;
	margin-bottom:0cm;
	margin-left:31.2pt;
	margin-bottom:.0001pt;
	line-height:10.0pt;
	mso-pagination:none;
	mso-hyphenate:none;
	tab-stops:2.0cm 3.0cm 4.0cm 5.0cm 6.0cm;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	border:none;
	mso-border-alt:solid white 1.5pt;
	padding:0cm;
	mso-padding-alt:1.0pt 2.0pt 1.0pt 15.0pt;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
span.codeintext-PRODUCTION
	{mso-style-name:"code in text - PRODUCTION";
	mso-style-parent:"";
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	letter-spacing:0pt;}
span.screentext-PRODUCTION
	{mso-style-name:"screen text - PRODUCTION";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Helvetica;
	mso-hansi-font-family:Helvetica;
	letter-spacing:.2pt;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-GB style='tab-interval:36.0pt'>

<div class=Section1>

<h3><span lang=EN-US>Outlook 2000</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>To use CDO,
you need to have the runtime DLL </span><span class=codeintext-PRODUCTION><span
style='font-family:Courier'>cdo.dll</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> on your system. Normally it’s located in </span><span
class=codeintext-PRODUCTION><span style='font-family:Courier'>C:\program
files\Common Files\System\Mapi\1033\NT</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>. If it’s not there and you can't find it
anywhere on your machine with </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Search | For Files or Folders</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, it means that CDO is not installed
yet. To install it, all you need do is launch Outlook 2000 setup, and check the
CDO box.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>If you use Outlook at work, most likely your
Outlook client talks to Exchange Server without you even realizing it. If
Outlook is set up to connect to Microsoft Exchange, which is most likely, then
you don't need to change any settings on your Outlook, and you can skip the
rest of this section. You will still need to ensure IIS is installed on your
machine and that your mail server can be visited from the Internet, covered in
the next section.<o:p></o:p></span></p>

<p class=MsoBlockText><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>Your Outlook set up may be configured for
Internet Mail Only, without having Exchange Server installed. If you use
Outlook at home to check your Internet emails, chances are you have it set up
in this way. To verify this, click </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Help | About Microsoft Outlook</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> after starting Outlook. If the
About dialog box shows </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Internet Mail Only</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'>, then you know your Outlook doesn't operate in
the client server Exchange configuration we need. If the About dialog box shows
</span><span class=screentext-PRODUCTION><span style='font-family:Helvetica'>No
E-mail</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>, then you
aren't currently using Outlook as your email application at all. For both these
cases, you will need to setup your mail support for Corporate or Workgroup.
This is because our ASP CDO code won't run successfully unless our logon and
profile is set up for use in a corporate environment, even a fake one.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoBlockText><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>To make CDO happy, we need to change the email
service option from </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>No E-mail</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> or </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Internet Mail Only</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> to </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Corporate or Workgroup</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, by going to </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Tools | Options
| Mail Delivery | Reconfigure Mail Support…</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> Then in the Outlook 2000 Startup dialog box,
select </span><span class=screentext-PRODUCTION><span style='font-family:Helvetica'>Corporate
or Workgroup</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>,
and click </span><span class=screentext-PRODUCTION><span style='font-family:
Helvetica'>Next</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>.
You'll see a message box informing you that </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Proceeding will
cause all users who use this machine to have this configuration.</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> Just go ahead and click </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Yes</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, unless there are indeed other
users using Outlook from the same machine, and then restart Outlook. To set it
back afterwards, simply repeat the above steps up to </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Reconfigure
Mail Support…</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>,
but this time choose </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>No E-mail</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> or </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Internet Mail Only</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> as appropriate.<o:p></o:p></span></p>

<p class=MsoBlockText><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>After you restart Outlook, the </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Help | About
Microsoft Outlook</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>
should now show </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Corporate or Workgroup</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. The other indications of the
change are that now you will see </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Services</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> instead of </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Accounts</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> in the Outlook </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Tools</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> menu, and the Main settings in
Control Panel now show </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Profiles</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> instead of just </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>Internet
accounts</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>. <o:p></o:p></span></p>

<p class=MsoBlockText><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>Still, why are we going through all this
trouble? Because to use CDO, we first need to log on, which requires a profile
name. If you use Internet Mail Only, you don't have a profile for CDO to log on
with. <o:p></o:p></span></p>

<p class=MsoBlockText><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBlockText style='margin-left:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>A word of warning is in order: if you change
your Outlook client from </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Internet Mail Only</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> to </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Corporate or Workgroup</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>, and then add a new profile for
your Internet mail accounts, be careful! Before you add a new profile and use
it, you'd be wise to save your emails and anything in other Outlook folders as
your new profile may make the messages in your previous setting inaccessible.<o:p></o:p></span></p>

<h3><span lang=EN-US>IIS and ASP</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ASP is
included in IIS 3.0 or above. You don't need to change any settings after you
install IIS 4.0 on NT 4 or IIS 5.0 on Windows 2000. The following lines can be
placed in an ASP file (don't forget to insert the profile name your Outlook
uses when starting, find it from </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Control Panel | Mail | Show Profiles…</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>) to test your setup:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div style='border:solid white 1.5pt;padding:1.0pt 2.0pt 1.0pt 15.0pt;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'>

<p class=codeforeground-PRODUCTION><span lang=EN-US>&lt;%<span
style="mso-spacerun: yes">    </span></span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>set Session(&quot;objsession&quot;)
= Server.CreateObject(&quot;MAPI.Session&quot;)</span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>rem there are two ways to
test CDO with IIS/ASP – both use the CDO Logon method.</span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>rem On NT 4, either method
will work fine; on Win2K, only the 2nd method works.</span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US><span style="mso-spacerun:
yes">  </span></span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>rem first, use a profile
name with the Logon method</span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>Session(&quot;objsession&quot;).Logon(&quot;your
default profile&quot;)</span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>rem if the above line
doesn’t work, comment it and uncomment the following lines rem
Session(&quot;objsession&quot;).Logon &quot;&quot;, &quot;&quot;, False, True,
0, True, </span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>rem
&quot;exchangeServerName&quot; &amp; vbLF &amp; &quot;exchangeE-MailName&quot;<span
style="mso-spacerun: yes">  </span></span></p>

<p class=codeforeground-PRODUCTION><span lang=EN-US>%&gt;</span></p>

</div>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If this
runs without error, then great, your system is correctly configured for running
ASP/CDO applications. If however, it doesn't work as it should, choose </span><span
class=screentext-PRODUCTION><span style='font-family:Helvetica'>View Source</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> in your browser, and if the above
lines have generated the error </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Collaboration Data Objects – [MAPI_E_LOGON_FAILED
(80040111)]</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>,
then it indicates you're dealing with a tricky beast: IIS authentication
failure. To resolve this issue, you have to set the Anonymous User on IIS to
your Outlook machine's logon name. For example, if you use the user name
Administrator to log on to your NT/Outlook/IIS machine, then open the IIS
Internet Service Manager. Go to </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Default Web Site Properties | Directory Security
| Anonymous Access and Authentication Control | Edit</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'>. In the Authentication Methods
dialog box, the </span><span class=screentext-PRODUCTION><span
style='font-family:Helvetica'>Allow Anonymous Access</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> option should be enabled. Click on
the </span><span class=screentext-PRODUCTION><span style='font-family:Helvetica'>Edit</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> button beside it, change the
Anonymous Username to the built-in Guest account of your login domain – or if
you use Outlook at home and don’t have a domain, you’ll have to use your logon
name. Now when you run the above ASP code, you shouldn't see any error
messages.<o:p></o:p></span></p>

<h3><span lang=EN-US>JSP</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>I've not
found ASP-based code to be well suited to uploading recorded messages, so I
have used JSP code for this task. Setting up a test Java web server is not too
difficult and the effort required is worthwhile in the long run. Here are the
steps you need to follow:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>1. If you
don't have JDK 1.2, download it from </span><span class=screentext-PRODUCTION><span
lang=EN-US style='font-family:Helvetica;mso-ansi-language:EN-US'>http://java.sun.com/j2ee/download.html.<o:p></o:p></span></span></p>

<p class=MsoNormal><span class=screentext-PRODUCTION><span lang=EN-US
style='font-family:Helvetica;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>2. Download
the JavaServer Web Development Kit (JSWDK) 1.0 if you don't already have a JSP
server installed. <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>3. After
installing JDK and JSWDK, open the file </span><span
class=codeintext-PRODUCTION><span style='font-family:Courier'>webserver.xml</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> in the JSWDK home directory and
check the default port number 8080. You will need to use this port number when
requesting documents from your JSP server. Also, note the following line: <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div style='border:solid white 1.5pt;padding:1.0pt 2.0pt 1.0pt 15.0pt;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'>

<p class=codeforeground-PRODUCTION><span lang=EN-US>&lt;WebApplication
id=&quot;voice&quot; mapping=&quot;/voice &quot; docBase=&quot;voice&quot;/&gt;</span></p>

</div>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>in the </span><span
class=codeintext-PRODUCTION><span style='font-family:Courier'>&lt;WebServer&gt;</span></span><span
style='mso-ansi-language:EN-US'> </span><span class=codeintext-PRODUCTION><span
style='font-family:Courier'>&lt;Service&gt;</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'> element to indicate where to look for voice
files. Of course, you'll need to create the directory </span><span
class=codeintext-PRODUCTION><span lang=EN-US style='font-family:Courier;
mso-ansi-language:EN-US'>voice</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'> inside the installed JSWDK directory.</span></p>

</div>

</body>

</html>
